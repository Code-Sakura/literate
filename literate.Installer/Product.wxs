<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
  <Package Name="Literate" Language="1033" Version="1.0.0.0" Manufacturer="CodeSakura" UpgradeCode="12345678-1234-1234-1234-123456789012" InstallerVersion="500">
    <SummaryInformation Keywords="Installer" Description="Literate Application Installer" />
    
    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
    <MediaTemplate EmbedCab="yes" />


    <Feature Id="ProductFeature" Title="Main Application" Level="1">
      <ComponentGroupRef Id="ProductComponents" />
      <ComponentGroupRef Id="AutoGeneratedFiles" />
    </Feature>
  </Package>

  <Fragment>
    <StandardDirectory Id="ProgramFiles64Folder">
      <Directory Id="INSTALLFOLDER" Name="Literate" />
    </StandardDirectory>
    <StandardDirectory Id="ProgramMenuFolder">
      <Directory Id="ApplicationProgramsFolder" Name="Literate" />
    </StandardDirectory>
  </Fragment>

  <Fragment>
    <ComponentGroup Id="AutoGeneratedFiles" Directory="INSTALLFOLDER">
      <Files Include="$(var.literate.TargetDir)**" />
    </ComponentGroup>
  </Fragment>

  <Fragment>
    <ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">
      <Component Id="ProgramMenuComponent" Directory="ApplicationProgramsFolder" Guid="B2C3D4E5-F678-9012-BCDE-F23456789012">
        <Shortcut Id="ApplicationStartMenuShortcut"
                  Name="Literate"
                  Description="Literate Application"
                  Target="[INSTALLFOLDER]literate.exe"
                  WorkingDirectory="INSTALLFOLDER" />
        <RemoveFolder Id="ApplicationProgramsFolder" On="uninstall" />
        <RegistryValue Root="HKCU" Key="Software\LiterateCompany\Literate" Name="installed" Type="integer" Value="1" KeyPath="yes" />
      </Component>
      
      <Component Id="RegistryComponent" Directory="INSTALLFOLDER" Guid="C3D4E5F6-7890-1234-CDEF-34567890ABCD">
        <RegistryKey Root="HKLM" Key="SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\Literate">
          <RegistryValue Name="DisplayName" Type="string" Value="Literate Application" />
          <RegistryValue Name="DisplayVersion" Type="string" Value="1.0.0.0" />
          <RegistryValue Name="Publisher" Type="string" Value="Literate Company" />
          <RegistryValue Name="InstallLocation" Type="string" Value="[INSTALLFOLDER]" />
          <RegistryValue Name="UninstallString" Type="string" Value="msiexec /x [ProductCode]" />
          <RegistryValue Name="NoRepair" Type="integer" Value="1" />
          <RegistryValue Name="NoModify" Type="integer" Value="1" />
        </RegistryKey>
        <RegistryValue Root="HKLM" Key="SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\Literate" Name="EstimatedSize" Type="integer" Value="1024" KeyPath="yes" />
      </Component>
      
      <Component Id="WebPContextMenuComponent" Directory="INSTALLFOLDER" Guid="{4E5F6A7B-8901-2345-A6B7-456789ABCDEF}">
        <RegistryKey Root="HKCR" Key="SystemFileAssociations\.webp\shell\Open with Literate">
          <RegistryValue Type="string" Value="Open with Literate" />
          <RegistryValue Name="Icon" Type="string" Value="[INSTALLFOLDER]literate.exe,0" />
          <RegistryValue Name="SupportedTypes" Type="string" Value=".webp" />
        </RegistryKey>
        <RegistryKey Root="HKCR" Key="SystemFileAssociations\.webp\shell\Open with Literate\command">
          <RegistryValue Type="string" Value="&quot;[INSTALLFOLDER]literate.exe&quot; &quot;%1&quot;" />
        </RegistryKey>
        <RegistryValue Root="HKCR" Key="SystemFileAssociations\.webp\shell\Open with Literate" Name="installed" Type="integer" Value="1" KeyPath="yes" />
      </Component>
      
      <Component Id="Windows11ContextMenuComponent" Directory="INSTALLFOLDER" Guid="{5F6A7B8C-9012-3456-B7C8-56789ABCDEF0}">
        <RegistryKey Root="HKLM" Key="SOFTWARE\Classes\*\shell\Literate">
          <RegistryValue Type="string" Value="Open with Literate" />
          <RegistryValue Name="Icon" Type="string" Value="[INSTALLFOLDER]literate.exe,0" />
          <RegistryValue Name="SupportedTypes" Type="string" Value=".webp" />
        </RegistryKey>
        <RegistryKey Root="HKLM" Key="SOFTWARE\Classes\*\shell\Literate\command">
          <RegistryValue Type="string" Value="&quot;[INSTALLFOLDER]literate.exe&quot; &quot;%1&quot;" />
        </RegistryKey>
        <RegistryValue Root="HKLM" Key="SOFTWARE\Classes\*\shell\Literate" Name="installed" Type="integer" Value="1" KeyPath="yes" />
      </Component>
      
      <ComponentRef Id="WebPContextMenuComponent" />
      <ComponentRef Id="Windows11ContextMenuComponent" />
    </ComponentGroup>
  </Fragment>
</Wix>